<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Soccer Lineup Builder</title>
    <style>
        :root {
            --pitch-green: #2e7d32;
            --line-white: rgba(255, 255, 255, 0.5);
            --accent: #007AFF;
        }

        body {
            font-family: sans-serif;
            margin: 0;
            background: #121212;
            color: white;
            display: flex;
            flex-direction: column;
            height: 100vh;
            overflow: hidden;
        }

        /* 1. THE PITCH */
        #pitch-container {
            position: relative;
            width: 100%;
            height: 60vh;
            background-color: var(--pitch-green);
            border-bottom: 5px solid #1b5e20;
        }

        #pitch {
            position: relative;
            width: 100%;
            height: 100%;
        }

        /* Simple Pitch Markings */
        .center-circle {
            position: absolute;
            top: 50%; left: 50%;
            transform: translate(-50%, -50%);
            width: 100px; height: 100px;
            border: 2px solid var(--line-white);
            border-radius: 50%;
        }

        /* 2. PLAYER STYLE */
        .player-jersey {
            position: absolute;
            width: 60px;
            text-align: center;
            cursor: grab;
            touch-action: none;
            transition: top 0.5s ease, left 0.5s ease; /* Smooth movement for formations */
            z-index: 10;
        }

        .jersey-img {
            width: 45px; height: 45px;
            background: #d32f2f;
            margin: 0 auto;
            border-radius: 50%;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            border: 2px solid white;
            box-shadow: 0 4px 6px rgba(0,0,0,0.3);
            background-size: cover;
            background-position: center;
        }

        .player-name {
            font-size: 11px;
            background: rgba(0,0,0,0.7);
            padding: 2px 4px;
            border-radius: 4px;
            margin-top: 3px;
        }

        /* 3. CONTROLS AREA */
        #controls {
            flex-grow: 1;
            padding: 15px;
            background: #1e1e1e;
            overflow-y: auto;
        }

        .section-title { font-size: 14px; margin-bottom: 10px; color: #888; text-transform: uppercase; }

        .input-group { display: flex; gap: 8px; margin-bottom: 10px; }
        
        input[type="text"], input[type="number"] {
            background: #333; border: 1px solid #444; color: white;
            padding: 10px; border-radius: 8px; flex: 1;
        }

        button {
            padding: 10px; background: var(--accent); color: white;
            border: none; border-radius: 8px; font-weight: bold; cursor: pointer;
        }

        .formation-btns {
            display: flex; gap: 10px; margin-top: 15px;
        }

        .form-btn { background: #444; flex: 1; }
    </style>
</head>
<body>

    <div id="pitch-container">
        <div class="center-circle"></div>
        <div id="pitch">
            </div>
    </div>

    <div id="controls">
        <p class="section-title">Add New Player</p>
        <div class="input-group">
            <input type="text" id="pName" placeholder="Name">
            <input type="number" id="pNum" placeholder="No." style="width: 70px;">
        </div>
        <div class="input-group">
            <input type="file" id="pJersey" accept="image/*" style="font-size: 12px;">
            <button onclick="addPlayer()">Add Player</button>
        </div>

        <p class="section-title" style="margin-top:20px;">Formations</p>
        <div class="formation-btns">
            <button class="form-btn" onclick="applyFormation('reset')">Clear Pitch</button>
            <button class="form-btn" onclick="applyFormation('341')">3 - 4 - 1</button>
        </div>
    </div>

    <script>
        let players = [];

        function addPlayer() {
            const name = document.getElementById('pName').value;
            const num = document.getElementById('pNum').value;
            const fileInput = document.getElementById('pJersey');

            if(!name || !num) return alert("Enter name and number!");
            if(players.length >= 8) return alert("Max 8 players for this layout!");

            const playerObj = { name, num, image: null };

            if (fileInput.files && fileInput.files[0]) {
                playerObj.image = URL.createObjectURL(fileInput.files[0]);
            }

            createPlayerElement(playerObj);
            players.push(playerObj);
        }

        function createPlayerElement(obj) {
            const el = document.createElement('div');
            el.className = 'player-jersey';
            el.style.left = '10px'; 
            el.style.top = '10px';

            const bgStyle = obj.image ? `background-image: url(${obj.image})` : '';

            el.innerHTML = `
                <div class="jersey-img" style="${bgStyle}">${obj.image ? '' : obj.num}</div>
                <div class="player-name">${obj.name}</div>
            `;

            makeDraggable(el);
            document.getElementById('pitch').appendChild(el);
            obj.element = el;
        }

        function applyFormation(type) {
            if (type === 'reset') {
                document.getElementById('pitch').innerHTML = '';
                players = [];
                return;
            }

            // 3-4-1 Coordinates (Percentage of Pitch)
            // [x, y] format
            const coords341 = [
                [50, 85], // GK (Optional 8th)
                [20, 65], [50, 65], [80, 65], // 3 Defenders
                [15, 40], [40, 40], [60, 40], [85, 40], // 4 Midfielders
                [50, 15]  // 1 Forward
            ];

            players.forEach((p, index) => {
                if (coords341[index]) {
                    p.element.style.left = `calc(${coords341[index][0]}% - 30px)`;
                    p.element.style.top = `calc(${coords341[index][1]}% - 30px)`;
                }
            });
        }

        function makeDraggable(el) {
            let isDragging = false;
            const start = () => { isDragging = true; el.style.transition = 'none'; };
            const end = () => { isDragging = false; el.style.transition = 'top 0.5s ease, left 0.5s ease'; };

            el.addEventListener('mousedown', start);
            el.addEventListener('touchstart', start);

            document.addEventListener('mousemove', (e) => {
                if (!isDragging) return;
                move(e.clientX, e.clientY);
            });

            document.addEventListener('touchmove', (e) => {
                if (!isDragging) return;
                move(e.touches[0].clientX, e.touches[0].clientY);
            });

            function move(clientX, clientY) {
                const pitch = document.getElementById('pitch').getBoundingClientRect();
                el.style.left = (clientX - pitch.left - 30) + 'px';
                el.style.top = (clientY - pitch.top - 30) + 'px';
            }

            document.addEventListener('mouseup', end);
            document.addEventListener('touchend', end);
        }
    </script>
</body>
</html>
